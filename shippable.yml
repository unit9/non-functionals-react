language: python
python:
- 2.7

env:
  global:
    # SERVICE_ACCOUNT_KEY
    - secure: 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
build:
  ci:
    - wget https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-183.0.0-linux-x86_64.tar.gz -O ~/google-cloud-sdk.tar.gz
    - tar xf ~/google-cloud-sdk.tar.gz -C ~/
    - ~/google-cloud-sdk/bin/gcloud components install app-engine-python app-engine-python-extras
    - echo $SERVICE_ACCOUNT_KEY > /tmp/key.json
    - ~/google-cloud-sdk/bin/gcloud -q auth activate-service-account --key-file /tmp/key.json
    - npm i --silent
    - npm run build:docs

  on_success:
    - ~/google-cloud-sdk/bin/gcloud app deploy app.yaml --project non-functionals-react --version $(echo $BRANCH  | sed -E 's/[_/]+/-/g') --no-promote

branches:
  only:
    - develop
    - master